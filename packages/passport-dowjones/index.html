<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#" lang="en">
  <head>
    <title>passport-dowjones</title>
    <meta charset="utf-8">
    <meta name="description" content="DowJones platform authentication strategy for Passport.js">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="canonical" href="https://www.passportjs.org/packages/passport-dowjones/">
    <link rel="manifest" href="/manifest.webmanifest"/>
    <meta name="theme-color" content="#35DF79"/>
    <link rel="shortcut icon" href="/images/favicon/favicon.ico"/>
    <link rel="icon" sizes="16x16" type="image/png" href="/images/favicon/favicon-16x16.png"/>
    <link rel="icon" sizes="32x32" type="image/png" href="/images/favicon/favicon-32x32.png"/>
    <link rel="icon" sizes="36x36" type="image/png" href="/images/favicon/android-icon-36x36.png"/>
    <link rel="icon" sizes="48x48" type="image/png" href="/images/favicon/android-icon-48x48.png"/>
    <link rel="icon" sizes="70x70" type="image/png" href="/images/favicon/ms-icon-70x70.png"/>
    <link rel="icon" sizes="72x72" type="image/png" href="/images/favicon/android-icon-72x72.png"/>
    <link rel="icon" sizes="96x96" type="image/png" href="/images/favicon/android-icon-96x96.png"/>
    <link rel="icon" sizes="144x144" type="image/png" href="/images/favicon/ms-icon-144x144.png"/>
    <link rel="icon" sizes="150x150" type="image/png" href="/images/favicon/ms-icon-150x150.png"/>
    <link rel="icon" sizes="192x192" type="image/png" href="/images/favicon/android-icon-192x192.png"/>
    <link rel="icon" sizes="310x310" type="image/png" href="/images/favicon/ms-icon-310x310.png"/>
    <link rel="apple-touch-icon" href="/images/favicon/apple-icon-57x57.png"/>
    <link rel="apple-touch-icon" sizes="60x60" href="/images/favicon/apple-icon-60x60.png"/>
    <link rel="apple-touch-icon" sizes="72x72" href="/images/favicon/apple-icon-72x72.png"/>
    <link rel="apple-touch-icon" sizes="76x76" href="/images/favicon/apple-icon-76x76.png"/>
    <link rel="apple-touch-icon" sizes="114x114" href="/images/favicon/apple-icon-114x114.png"/>
    <link rel="apple-touch-icon" sizes="120x120" href="/images/favicon/apple-icon-120x120.png"/>
    <link rel="apple-touch-icon" sizes="144x144" href="/images/favicon/apple-icon-144x144.png"/>
    <link rel="apple-touch-icon" sizes="152x152" href="/images/favicon/apple-icon-152x152.png"/>
    <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-icon-180x180.png"/>
    <meta name="msapplication-config" content="/browserconfig.xml"/>
    <meta name="msapplication-TileColor" content="#35DF79"/>
    <meta name="msapplication-TileImage" content="/images/favicon/ms-icon-144x144.png"/>
    <meta property="og:type" content="website"/>
    <meta property="og:title" content="passport-dowjones"/>
    <meta property="og:description" content="DowJones platform authentication strategy for Passport.js"/>
    <meta property="og:url" content="https://www.passportjs.org/packages/passport-dowjones/"/>
    <meta property="og:image" content="https://www.passportjs.org/images/facebook-card.png"/>
    <meta property="og:image:type" content="image/png"/>
    <meta property="og:image:width" content="1200"/>
    <meta property="og:image:height" content="630"/>
    <meta property="og:site_name" content="Passport.js"/>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:site" content="@passportjs"/>
    <meta name="twitter:title" content="passport-dowjones"/>
    <meta name="twitter:description" content="DowJones platform authentication strategy for Passport.js"/>
    <meta name="twitter:image" content="https://www.passportjs.org/images/twitter-card.png"/>
    <meta name="flattr:id" content="d5znvd"/>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      
      ga('create', 'UA-73332146-2', 'auto');
      ga('send', 'pageview');
    </script>
    <!--+google-tag-manager('GTM-M5S3PH')-->
    <!--link(type='text/css', rel='stylesheet', href='http://fast.fonts.net/cssapi/7527d73a-ebfe-45db-a201-ff2812df4b18.css')-->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/default.min.css">
    <link rel="stylesheet" href="/assets/styles/all.css">
    <script data-main="/script/main" src="//cdnjs.cloudflare.com/ajax/libs/require.js/2.3.5/require.js"></script>
  </head>
  <body>
    <div id="container"><span id="top"></span>
      <div id="toolbar">
        <div class="toolbar-search">
          <form action="/search">
            <button type="submit"></button>
            <input type="text" name="q" placeholder="Search for Strategies">
          </form>
        </div>
        <div class="toolbar-social">
          <ul>
            <li class="facebook"><a href="https://www.facebook.com/passportjs" target="_blank"></a></li>
            <li class="twitter"><a href="https://twitter.com/passportjs" target="_blank"></a></li>
            <li class="github"><a href="https://github.com/jaredhanson/passport" target="_blank"><span class="count">0</span></a></li>
          </ul>
        </div>
      </div>
      <nav id="menu"><a class="menu-logo" href="/" title="Passport.js"></a>
        <div class="menu-trigger"><span></span></div>
        <div class="menu-items">
          <ul>
            <li><a href="/">Home</a></li>
            <li><a href="/docs/">Documentation</a></li>
            <li><a href="/features/">Features</a></li>
            <li><a href="/packages/">Strategies</a></li>
            <li><a href="/sponsors/">Sponsors</a></li>
          </ul><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=passportjsorg" id="_carbonads_js"></script>
        </div>
      </nav>
      <div id="content">
        <div class="package hproduct" id="package">
          <div class="description"><p>#Authentication</p>
<h2 id="getting-application-credentials">Getting Application credentials</h2>
<p>You will need to reach out to DowJones to get your clientID, clientSecret and establish
your callback URL.  Once you have set these values, you can get to them by going
to your <a href="https://dowjones.com/page-to-be-defined">Dow Jones Client Settings</a></p>
<h2 id="installation">Installation</h2>
<pre><code>npm <span class="keyword">install</span> passport-dowjones
npm <span class="keyword">install</span> express
</code></pre><p>For other related passport functionality, such as session management, please see the <a href="http://passportjs.org/">passport.js</a> site.  This
example relies on the express-session npm package, but other session managers could be used in its place.</p>
<h2 id="configuration">Configuration</h2>
<p>Take your credentials from the <a href="https://dowjones.com/page-to-be-defined">Dow Jones Client Settings</a> section described above and initialize the strategy as follows:</p>
<pre><code class="js"><span class="keyword">var</span> <span class="title class_">DowJonesStrategy</span> = <span class="built_in">require</span>(<span class="string">&#x27;passport-dowjones&#x27;</span>),
    passport = <span class="built_in">require</span>(<span class="string">&#x27;passport&#x27;</span>);

<span class="keyword">var</span> strategy = <span class="keyword">new</span> <span class="title class_">DowJonesStrategy</span>({
   <span class="attr">clientID</span>:     <span class="string">&#x27;your-client-id&#x27;</span>,
   <span class="attr">clientSecret</span>: <span class="string">&#x27;your-client-secret&#x27;</span>,
   <span class="attr">callbackURL</span>:  <span class="string">&#x27;/callback&#x27;</span>
  },
  <span class="keyword">function</span>(<span class="params">accessToken, refreshToken, extraParams, profile, done</span>) {
    <span class="comment">// accessToken is the token to call oAuth API (not needed in the most cases)</span>
    <span class="comment">// extraParams.id_token has the JSON Web Token</span>
    <span class="comment">// profile has all the information from the user</span>

    <span class="comment">// next we&#x27;ll grab the api token and store it as part of the session</span>
    <span class="keyword">var</span> apiToken = <span class="variable language_">this</span>.<span class="title function_">getDelegationToken</span>(<span class="params">extraParams, <span class="string">&#x27;pib&#x27;</span></span>) {
      <span class="keyword">if</span>(err !== <span class="literal">undefined</span>) {
        <span class="keyword">return</span> <span class="title function_">done</span>(err);
      }
      <span class="comment">// store the apiToken in session</span>
      session.<span class="property">apiToken</span> = apiToken;

      <span class="keyword">return</span> <span class="title function_">done</span>(<span class="literal">null</span>, profile);
    });
  }
);

passport.<span class="title function_">use</span>(strategy);
</code></pre><h2 id="usage">Usage</h2>
<p>For this application, we support login and the callback interface.  Passport supports other mechanisms to for remaining endpoints,
but we will focus on login here.</p>
<p>First, create the login endpoint that</p>
<pre><code class="js">app.<span class="title function_">get</span>(<span class="string">&#x27;/login&#x27;</span>,
  passport.<span class="title function_">authenticate</span>(<span class="string">&#x27;dowjones&#x27;</span>, {<span class="attr">connection</span>: <span class="string">&#x27;dj-piboauthv2&#x27;</span>}));
</code></pre><p>Next, we&#39;ll create the callback interface that gets invoked after login completes.  Note that we get an
API token by calling delegate passing the references</p>
<pre><code class="js">app.<span class="title function_">get</span>(<span class="string">&#x27;/callback&#x27;</span>,
  passport.<span class="title function_">authenticate</span>(<span class="string">&#x27;dowjones&#x27;</span>, { <span class="attr">failureRedirect</span>: <span class="string">&#x27;/login&#x27;</span> }),
  <span class="keyword">function</span>(<span class="params">req, res</span>) {
    <span class="keyword">if</span> (!req.<span class="property">user</span>) {
      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;user null&#x27;</span>);
    }

    res.<span class="title function_">redirect</span>(<span class="string">&quot;/&quot;</span>);
  }
);
</code></pre><h2 id="alternate--authenticating-using-openidoauth-requests">Alternate:  Authenticating using OpenID/oAuth Requests</h2>
<p>The DowJones Authentication API is built on OpenID and oAuth.  Compatible libraries can be used to perform authentication.  The
call sequence for authentication is as follows:</p>
<p><img src="http://www.websequencediagrams.com/files/render?link=r_EJ10NaljsGPxFk033c" alt="DowJones Authentication Sequence Diagram"></p>
<h2 id="calling-the-api">Calling the API</h2>
<h2 id="complete-example">Complete example</h2>
<p>A complete example of using this library <a href="http://github.com/dowjones/passport-dowjones-sample">here</a>.</p>
<h2 id="documentation">Documentation</h2>
<p>For more information about <a href="http://dowjones.com">DowJones</a> contact our <a href="http://dowjones.com/tbd">documentation page</a>.</p>
<h2 id="author">Author</h2>
<p><a href="dowjones.com">Dow Jones</a></p>
<h2 id="license">License</h2>
<p>This project is licensed under the MIT license. See the <a href="LICENSE">LICENSE</a> file for more info.</p>
</div>
          <div class="metadata">
            <div class="install"><code>npm install <span class="fn">passport-dowjones</span></code></div>
            <ul>
              <li><span class="version">0.2.2</span> published <abbr class="updated" title="2022-06-23T12:30:33Z">2 years ago</abbr></li>
              <li><a class="url" href="https://github.com/dowjones/passport-dowjones">https://github.com/DowJones/passport-dowjones#readme</a></li>
              <li><a rel="licence" href="http://www.opensource.org/licenses/MIT">MIT License</a></li>
            </ul>
            <ul>
              <li><b>0</b> downloads in the last day</li>
              <li><b>2</b> downloads in the last week</li>
              <li><b>6</b> downloads in the last month</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <div class="search-con">
      <div class="head"><span class="close-ico"></span>
        <div class="hold">
          <h2>SEARCH FOR STRATEGIES</h2>
          <form action="/">
            <input value="" type="text" name="strategy" placeholder="Start typing" autocomplete="off">
          </form>
          <p class="info-line"><span>0</span>STRATEGIES</p>
        </div>
      </div>
      <div class="results">
        <section></section>
      </div>
    </div>
    <!--+google-tag-manager-noscript('GTM-M5S3PH')-->
  </body>
</html>